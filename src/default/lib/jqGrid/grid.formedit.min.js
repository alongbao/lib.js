(function(a){a.jgrid.extend({searchGrid:function(b){b=a.extend({recreateFilter:!1,drag:!0,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",loadDefaults:!0,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,afterRedraw:null,closeAfterSearch:!1,closeAfterReset:!1,closeOnEscape:!1,multipleSearch:!1,multipleGroup:!1,top:0,left:0,jqModal:!0,modal:!1,resize:!0,width:450,height:"auto",dataheight:"auto",showQuery:!1,errorcheck:!0,sopt:null,stringResult:undefined,onClose:null,onSearch:null,onReset:null,toTop:!0,overlay:10,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:!1,layer:null},a.jgrid.search,b||{});return this.each(function(){function h(){a.isFunction(b.beforeShowSearch)&&(e=b.beforeShowSearch(a("#"+d)),typeof e=="undefined"&&(e=!0)),e&&(a.jgrid.viewModal("#"+f.themodal,{gbox:"#gbox_"+d,jqm:b.jqModal,modal:b.modal,overlay:b.overlay,toTop:b.toTop}),a.isFunction(b.afterShowSearch)&&b.afterShowSearch(a("#"+d)))}var c=this;if(!!c.grid){var d="fbox_"+c.p.id,e=!0,f={themodal:"searchmod"+d,modalhead:"searchhd"+d,modalcontent:"searchcnt"+d,scrollelm:d},g=c.p.postData[b.sFilter];typeof g=="string"&&(g=a.jgrid.parse(g)),b.recreateFilter===!0&&a("#"+f.themodal).remove();if(a("#"+f.themodal).html()!==null)h();else{var i=a("<span><div id='"+d+"' class='searchFilter' style='overflow:auto'></div></span>").insertBefore("#gview_"+c.p.id);a.isFunction(b.onInitializeSearch)&&b.onInitializeSearch(a("#"+d));var j=a.extend([],c.p.colModel),k="<a href='javascript:void(0)' id='"+d+"_search' class='fm-button ui-state-default ui-corner-all fm-button-icon-right ui-reset'><span class='ui-icon ui-icon-search'></span>"+b.Find+"</a>",l="<a href='javascript:void(0)' id='"+d+"_reset' class='fm-button ui-state-default ui-corner-all fm-button-icon-left ui-search'><span class='ui-icon ui-icon-arrowreturnthick-1-w'></span>"+b.Reset+"</a>",m="",n="",o,q=!1,r,s=-1;b.showQuery&&(m="<a href='javascript:void(0)' id='"+d+"_query' class='fm-button ui-state-default ui-corner-all fm-button-icon-left'><span class='ui-icon ui-icon-comment'></span>Query</a>"),b.columns.length?j=b.columns:a.each(j,function(a,b){b.label||(b.label=c.p.colNames[a]);if(!q){var d=typeof b.search=="undefined"?!0:b.search,e=b.hidden===!0,f=b.searchoptions&&b.searchoptions.searchhidden===!0;if(f&&d||d&&!e)q=!0,o=b.index||b.name,s=a}});if(!g&&o||b.multipleSearch===!1){var t="eq";s>=0&&j[s].searchoptions&&j[s].searchoptions.sopt?t=j[s].searchoptions.sopt[0]:b.sopt&&b.sopt.length&&(t=b.sopt[0]),g={groupOp:"AND",rules:[{field:o,op:t,data:""}]}}q=!1,b.tmplNames&&b.tmplNames.length&&(q=!0,n=b.tmplLabel,n+="<select class='ui-template'>",n+="<option value='default'>Default</option>",a.each(b.tmplNames,function(a,b){n+="<option value='"+a+"'>"+b+"</option>"}),n+="</select>"),r="<table class='EditTable' style='border:0px none;margin-top:5px' id='"+d+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr><td class='EditButton' style='text-align:left'>"+l+n+"</td><td class='EditButton'>"+m+k+"</td></tr></tbody></table>",a("#"+d).jqFilter({columns:j,filter:b.loadDefaults?g:null,showQuery:b.showQuery,errorcheck:b.errorcheck,sopt:b.sopt,groupButton:b.multipleGroup,ruleButtons:b.multipleSearch,afterRedraw:b.afterRedraw,_gridsopt:a.jgrid.search.odata,onChange:function(b){this.p.showQuery&&a(".query",this).html(this.toUserFriendlyString())}}),i.append(r),q&&b.tmplFilters&&b.tmplFilters.length&&a(".ui-template",i).bind("change",function(c){var e=a(this).val();e=="default"?a("#"+d).jqFilter("addFilter",g):a("#"+d).jqFilter("addFilter",b.tmplFilters[parseInt(e,10)]);return!1}),b.multipleGroup===!0&&(b.multipleSearch=!0),a.isFunction(b.onInitializeSearch)&&b.onInitializeSearch(a("#"+d)),b.layer?a.jgrid.createModal(f,i,b,"#gview_"+c.p.id,a("#gbox_"+c.p.id)[0],"#"+b.layer,{position:"relative"}):a.jgrid.createModal(f,i,b,"#gview_"+c.p.id,a("#gbox_"+c.p.id)[0]),m&&a("#"+d+"_query").bind("click",function(b){a(".queryresult",i).toggle();return!1}),b.stringResult===undefined&&(b.stringResult=b.multipleSearch),a("#"+d+"_search").bind("click",function(){var e=a("#"+d),g={},h,i=e.jqFilter("filterData");if(b.errorcheck){e[0].hideError(),b.showQuery||e.jqFilter("toSQLString");if(e[0].p.error){e[0].showError();return!1}}if(b.stringResult){try{h=xmlJsonClass.toJson(i,"","",!1)}catch(j){try{h=JSON.stringify(i)}catch(k){}}typeof h=="string"&&(g[b.sFilter]=h,a.each([b.sField,b.sValue,b.sOper],function(){g[this]=""}))}else b.multipleSearch?(g[b.sFilter]=i,a.each([b.sField,b.sValue,b.sOper],function(){g[this]=""})):(g[b.sField]=i.rules[0].field,g[b.sValue]=i.rules[0].data,g[b.sOper]=i.rules[0].op,g[b.sFilter]="");c.p.search=!0,a.extend(c.p.postData,g),a.isFunction(b.onSearch)&&b.onSearch(),a(c).trigger("reloadGrid",[{page:1}]),b.closeAfterSearch&&a.jgrid.hideModal("#"+f.themodal,{gb:"#gbox_"+c.p.id,jqm:b.jqModal,onClose:b.onClose});return!1}),a("#"+d+"_reset").bind("click",function(){var e={},f=a("#"+d);c.p.search=!1,b.multipleSearch===!1?e[b.sField]=e[b.sValue]=e[b.sOper]="":e[b.sFilter]="",f[0].resetFilter(),q&&a(".ui-template",i).val("default"),a.extend(c.p.postData,e),a.isFunction(b.onReset)&&b.onReset(),a(c).trigger("reloadGrid",[{page:1}]);return!1}),h(),a(".fm-button:not(.ui-state-disabled)",i).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")})}}})},editGridRow:function(b,c){c=a.extend({top:0,left:0,width:300,height:"auto",dataheight:"auto",modal:!1,overlay:10,drag:!0,resize:!0,url:null,mtype:"POST",clearAfterAdd:!0,closeAfterEdit:!1,reloadAfterSubmit:!0,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},recreateForm:!1,jqModal:!0,closeOnEscape:!1,addedrow:"first",topinfo:"",bottominfo:"",saveicon:[],closeicon:[],savekey:[!1,13],navkeys:[!1,38,40],checkOnSubmit:!1,checkOnUpdate:!1,_savedData:{},processing:!1,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:!0},a.jgrid.edit,c||{});var d=c;return this.each(function(){function H(){var b=a(e).jqGrid("getDataIDs"),c=a("#id_g","#"+h).val(),d=a.inArray(c,b);return[d,b]}function G(b,c){b===0?a("#pData","#"+h+"_2").addClass("ui-state-disabled"):a("#pData","#"+h+"_2").removeClass("ui-state-disabled"),b==c?a("#nData","#"+h+"_2").addClass("ui-state-disabled"):a("#nData","#"+h+"_2").removeClass("ui-state-disabled")}function F(){if(b!=="_empty"&&typeof e.p.savedRow!="undefined"&&e.p.savedRow.length>0&&a.isFunction(a.fn.jqGrid.restoreRow))for(var c=0;c<e.p.savedRow.length;c++)if(e.p.savedRow[c].id==b){a(e).jqGrid("restoreRow",b);break}}function E(){var b=!0;a("#FormError","#"+h).hide(),d.checkOnUpdate&&(t={},u={},y(),v=a.extend({},t,u),w=C(v,d._savedData),w&&(a("#"+g).data("disabled",!0),a(".confirm","#"+j.themodal).show(),b=!1));return b}function D(){a.each(e.p.colModel,function(a,b){b.editoptions&&b.editoptions.NullIfEmpty===!0&&t.hasOwnProperty(b.name)&&t[b.name]==""&&(t[b.name]="null")})}function C(a,b){var c=!1,d;for(d in a)if(a[d]!=b[d]){c=!0;break}return c}function B(){var b,k=[!0,"",""],l={},m=e.p.prmNames,n,o,q,r;if(a.isFunction(d.beforeCheckValues)){var s=d.beforeCheckValues(t,a("#"+g),t[e.p.id+"_id"]=="_empty"?m.addoper:m.editoper);s&&typeof s=="object"&&(t=s)}for(q in t)if(t.hasOwnProperty(q)){k=a.jgrid.checkValues(t[q],q,e);if(k[0]===!1)break}D(),k[0]&&(a.isFunction(d.onclickSubmit)&&(l=d.onclickSubmit(d,t)||{}),a.isFunction(d.beforeSubmit)&&(k=d.beforeSubmit(t,a("#"+g))));if(k[0]&&!d.processing){d.processing=!0,a("#sData","#"+h+"_2").addClass("ui-state-active"),o=m.oper,n=m.id,t[o]=a.trim(t[e.p.id+"_id"])=="_empty"?m.addoper:m.editoper,t[o]!=m.addoper?t[n]=t[e.p.id+"_id"]:t[n]===undefined&&(t[n]=t[e.p.id+"_id"]),delete t[e.p.id+"_id"],t=a.extend(t,d.editData,l);if(e.p.treeGrid===!0){if(t[o]==m.addoper){r=a(e).jqGrid("getGridParam","selrow");var v=e.p.treeGridModel=="adjacency"?e.p.treeReader.parent_id_field:"parent_id";t[v]=r}for(i in e.p.treeReader){var w=e.p.treeReader[i];if(t.hasOwnProperty(w)){if(t[o]==m.addoper&&i==="parent_id_field")continue;delete t[w]}}}var x=a.extend({url:d.url?d.url:a(e).jqGrid("getGridParam","editurl"),type:d.mtype,data:a.isFunction(d.serializeEditData)?d.serializeEditData(t):t,complete:function(i,l){l!="success"?(k[0]=!1,a.isFunction(d.errorTextFormat)?k[1]=d.errorTextFormat(i):k[1]=l+" Status: '"+i.statusText+"'. Error code: "+i.status):a.isFunction(d.afterSubmit)&&(k=d.afterSubmit(i,t));if(k[0]===!1)a("#FormError>td","#"+h).html(k[1]),a("#FormError","#"+h).show();else{a.each(e.p.colModel,function(a,b){if(u[this.name]&&this.formatter&&this.formatter=="select")try{delete u[this.name]}catch(c){}}),t=a.extend(t,u),e.p.autoencode&&a.each(t,function(b,c){t[b]=a.jgrid.htmlDecode(c)}),d.reloadAfterSubmit=d.reloadAfterSubmit&&e.p.datatype!="local",t[o]==m.addoper?(k[2]||(k[2]=a.jgrid.randId()),t[n]=k[2],d.closeAfterAdd?(d.reloadAfterSubmit?a(e).trigger("reloadGrid"):e.p.treeGrid===!0?a(e).jqGrid("addChildNode",k[2],r,t):(a(e).jqGrid("addRowData",k[2],t,c.addedrow),a(e).jqGrid("setSelection",k[2])),a.jgrid.hideModal("#"+j.themodal,{gb:"#gbox_"+f,jqm:c.jqModal,onClose:d.onClose})):d.clearAfterAdd?(d.reloadAfterSubmit?a(e).trigger("reloadGrid"):e.p.treeGrid===!0?a(e).jqGrid("addChildNode",k[2],r,t):a(e).jqGrid("addRowData",k[2],t,c.addedrow),A("_empty",e,g)):d.reloadAfterSubmit?a(e).trigger("reloadGrid"):e.p.treeGrid===!0?a(e).jqGrid("addChildNode",k[2],r,t):a(e).jqGrid("addRowData",k[2],t,c.addedrow)):(d.reloadAfterSubmit?(a(e).trigger("reloadGrid"),d.closeAfterEdit||setTimeout(function(){a(e).jqGrid("setSelection",t[n])},1e3)):e.p.treeGrid===!0?a(e).jqGrid("setTreeRow",t[n],t):a(e).jqGrid("setRowData",t[n],t),d.closeAfterEdit&&a.jgrid.hideModal("#"+j.themodal,{gb:"#gbox_"+f,jqm:c.jqModal,onClose:d.onClose})),a.isFunction(d.afterComplete)&&(b=i,setTimeout(function(){d.afterComplete(b,t,a("#"+g)),b=null},500));if(d.checkOnSubmit||d.checkOnUpdate){a("#"+g).data("disabled",!1);if(d._savedData[e.p.id+"_id"]!="_empty")for(var q in d._savedData)t[q]&&(d._savedData[q]=t[q])}}d.processing=!1,a("#sData","#"+h+"_2").removeClass("ui-state-active");try{a(":input:visible","#"+g)[0].focus()}catch(s){}}},a.jgrid.ajaxOptions,d.ajaxEditOptions);!x.url&&!d.useDataProxy&&(a.isFunction(e.p.dataProxy)?d.useDataProxy=!0:(k[0]=!1,k[1]+=" "+a.jgrid.errors.nourl)),k[0]&&(d.useDataProxy?e.p.dataProxy.call(e,x,"set_"+e.p.id):a.ajax(x))}k[0]===!1&&(a("#FormError>td","#"+h).html(k[1]),a("#FormError","#"+h).show())}function A(b,c,f){var g,i=0,j,k,l,m,n;if(d.checkOnSubmit||d.checkOnUpdate)d._savedData={},d._savedData[c.p.id+"_id"]=b;var o=c.p.colModel;if(b=="_empty")a(o).each(function(b){g=this.name,l=a.extend({},this.editoptions||{}),k=a("#"+a.jgrid.jqID(g),"#"+f);if(k&&k.length&&k[0]!==null){m="",l.defaultValue?(m=a.isFunction(l.defaultValue)?l.defaultValue():l.defaultValue,k[0].type=="checkbox"?(n=m.toLowerCase(),n.search(/(false|0|no|off|undefined)/i)<0&&n!==""?(k[0].checked=!0,k[0].defaultChecked=!0,k[0].value=m):k.attr({checked:"",defaultChecked:""})):k.val(m)):k[0].type=="checkbox"?(k[0].checked=!1,k[0].defaultChecked=!1,m=a(k).attr("offval")):k[0].type&&k[0].type.substr(0,6)=="select"?k[0].selectedIndex=0:k.val(m);if(d.checkOnSubmit===!0||d.checkOnUpdate)d._savedData[g]=m}}),a("#id_g","#"+f).val(b);else{var p=a(c).jqGrid("getInd",b,!0);if(!p)return;a("td",p).each(function(h){g=o[h].name;if(g!=="cb"&&g!=="subgrid"&&g!=="rn"&&o[h].editable===!0){if(g==c.p.ExpandColumn&&c.p.treeGrid===!0)j=a(this).text();else try{j=a.unformat(a(this),{rowId:b,colModel:o[h]},h)}catch(k){j=o[h].edittype=="textarea"?a(this).text():a(this).html()}e.p.autoencode&&(j=a.jgrid.htmlDecode(j));if(d.checkOnSubmit===!0||d.checkOnUpdate)d._savedData[g]=j;g=a.jgrid.jqID(g);switch(o[h].edittype){case"password":case"text":case"button":case"image":case"textarea":if(j=="&nbsp;"||j=="&#160;"||j.length==1&&j.charCodeAt(0)==160)j="";a("#"+g,"#"+f).val(j);break;case"select":var l=j.split(",");l=a.map(l,function(b){return a.trim(b)}),a("#"+g+" option","#"+f).each(function(b){!!o[h].editoptions.multiple||l[0]!=a.trim(a(this).text())&&l[0]!=a.trim(a(this).val())?o[h].editoptions.multiple?a.inArray(a.trim(a(this).text()),l)>-1||a.inArray(a.trim(a(this).val()),l)>-1?this.selected=!0:this.selected=!1:this.selected=!1:this.selected=!0});break;case"checkbox":j=j+"";if(o[h].editoptions&&o[h].editoptions.value){var m=o[h].editoptions.value.split(":");m[0]==j?(a("#"+g,"#"+f).attr("checked",!0),a("#"+g,"#"+f).attr("defaultChecked",!0)):(a("#"+g,"#"+f).attr("checked",!1),a("#"+g,"#"+f).attr("defaultChecked",""))}else j=j.toLowerCase(),j.search(/(false|0|no|off|undefined)/i)<0&&j!==""?(a("#"+g,"#"+f).attr("checked",!0),a("#"+g,"#"+f).attr("defaultChecked",!0)):(a("#"+g,"#"+f).attr("checked",!1),a("#"+g,"#"+f).attr("defaultChecked",""));break;case"custom":try{if(o[h].editoptions&&a.isFunction(o[h].editoptions.custom_value))o[h].editoptions.custom_value(a("#"+g,"#"+f),"set",j);else throw"e1"}catch(n){n=="e1"?a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.nodefined,jQuery.jgrid.edit.bClose):a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,n.message,jQuery.jgrid.edit.bClose)}}i++}}),i>0&&a("#id_g","#"+h).val(b)}}function z(b,c,f,g){var h,i,j,k=0,l,m,n,o=[],p=!1,q="<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>",r="",s;for(s=1;s<=g;s++)r+=q;b!="_empty"&&(p=a(c).jqGrid("getInd",b)),a(c.p.colModel).each(function(q){h=this.name,this.editrules&&this.editrules.edithidden===!0?i=!1:i=this.hidden===!0?!0:!1,m=i?"style='display:none'":"";if(h!=="cb"&&h!=="subgrid"&&this.editable===!0&&h!=="rn"){if(p===!1)l="";else if(h==c.p.ExpandColumn&&c.p.treeGrid===!0)l=a("td:eq("+q+")",c.rows[p]).text();else{try{l=a.unformat(a("td:eq("+q+")",c.rows[p]),{rowId:b,colModel:this},q)}catch(s){l=this.edittype&&this.edittype=="textarea"?a("td:eq("+q+")",c.rows[p]).text():a("td:eq("+q+")",c.rows[p]).html()}if(!l||l=="&nbsp;"||l=="&#160;"||l.length==1&&l.charCodeAt(0)==160)l=""}var t=a.extend({},this.editoptions||{},{id:h,name:h}),u=a.extend({},{elmprefix:"",elmsuffix:"",rowabove:!1,rowcontent:""},this.formoptions||{}),v=parseInt(u.rowpos,10)||k+1,w=parseInt((parseInt(u.colpos,10)||1)*2,10);b=="_empty"&&t.defaultValue&&(l=a.isFunction(t.defaultValue)?t.defaultValue():t.defaultValue),this.edittype||(this.edittype="text"),e.p.autoencode&&(l=a.jgrid.htmlDecode(l)),n=a.jgrid.createEl(this.edittype,t,l,!1,a.extend({},a.jgrid.ajaxOptions,c.p.ajaxSelectOptions||{})),l===""&&this.edittype=="checkbox"&&(l=a(n).attr("offval")),l===""&&this.edittype=="select"&&(l=a("option:eq(0)",n).text());if(d.checkOnSubmit||d.checkOnUpdate)d._savedData[h]=l;a(n).addClass("FormElement"),(this.edittype=="text"||this.edittype=="textarea")&&a(n).addClass("ui-widget-content ui-corner-all"),j=a(f).find("tr[rowpos="+v+"]");if(u.rowabove){var x=a("<tr><td class='contentinfo' colspan='"+g*2+"'>"+u.rowcontent+"</td></tr>");a(f).append(x),x[0].rp=v}j.length===0&&(j=a("<tr "+m+" rowpos='"+v+"'></tr>").addClass("FormData").attr("id","tr_"+h),a(j).append(r),a(f).append(j),j[0].rp=v),a("td:eq("+(w-2)+")",j[0]).html(typeof u.label=="undefined"?c.p.colNames[q]:u.label),a("td:eq("+(w-1)+")",j[0]).append(u.elmprefix).append(n).append(u.elmsuffix),o[k]=q,k++}});if(k>0){var t=a("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(g*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+c.p.id+"_id' value='"+b+"'/></td></tr>");t[0].rp=k+999,a(f).append(t);if(d.checkOnSubmit||d.checkOnUpdate)d._savedData[c.p.id+"_id"]=b}return o}function y(){a("#"+h+" > tbody > tr > td > .FormElement").each(function(b){var c=a(".customelement",this);if(c.length){var d=c[0],f=a(d).attr("name");a.each(e.p.colModel,function(b,c){if(this.name===f&&this.editoptions&&a.isFunction(this.editoptions.custom_value)){try{t[f]=this.editoptions.custom_value(a("#"+a.jgrid.jqID(f),"#"+h),"get");if(t[f]===undefined)throw"e1"}catch(d){d==="e1"?a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.novalue,jQuery.jgrid.edit.bClose):a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,d.message,jQuery.jgrid.edit.bClose)}return!0}})}else{switch(a(this).get(0).type){case"checkbox":if(a(this).attr("checked"))t[this.name]=a(this).val();else{var g=a(this).attr("offval");t[this.name]=g}break;case"select-one":t[this.name]=a("option:selected",this).val(),u[this.name]=a("option:selected",this).text();break;case"select-multiple":t[this.name]=a(this).val(),t[this.name]?t[this.name]=t[this.name].join(","):t[this.name]="";var i=[];a("option:selected",this).each(function(b,c){i[b]=a(c).text()}),u[this.name]=i.join(",");break;case"password":case"text":case"textarea":case"button":t[this.name]=a(this).val()}e.p.autoencode&&(t[this.name]=a.jgrid.htmlEncode(t[this.name]))}});return!0}var e=this;if(!!e.grid&&!!b){var f=e.p.id,g="FrmGrid_"+f,h="TblGrid_"+f,j={themodal:"editmod"+f,modalhead:"edithd"+f,modalcontent:"editcnt"+f,scrollelm:g},k=a.isFunction(d.beforeShowForm)?d.beforeShowForm:!1,l=a.isFunction(d.afterShowForm)?d.afterShowForm:!1,m=a.isFunction(d.beforeInitData)?d.beforeInitData:!1,n=a.isFunction(d.onInitializeForm)?d.onInitializeForm:!1,o=null,q=!0,r=1,s=0,t,u,v,w;b==="new"?(b="_empty",c.caption=d.addCaption):c.caption=d.editCaption,c.recreateForm===!0&&a("#"+j.themodal).html()!==null&&a("#"+j.themodal).remove();var x=!0;c.checkOnUpdate&&c.jqModal&&!c.modal&&(x=!1);if(a("#"+j.themodal).html()!==null){m&&(q=m(a("#"+g)),typeof q=="undefined"&&(q=!0));if(q===!1)return;F(),a(".ui-jqdialog-title","#"+j.modalhead).html(c.caption),a("#FormError","#"+h).hide(),d.topinfo?(a(".topinfo","#"+h+"_2").html(d.topinfo),a(".tinfo","#"+h+"_2").show()):a(".tinfo","#"+h+"_2").hide(),d.bottominfo?(a(".bottominfo","#"+h+"_2").html(d.bottominfo),a(".binfo","#"+h+"_2").show()):a(".binfo","#"+h+"_2").hide(),A(b,e,g),b=="_empty"||!d.viewPagerButtons?a("#pData, #nData","#"+h+"_2").hide():a("#pData, #nData","#"+h+"_2").show(),d.processing===!0&&(d.processing=!1,a("#sData","#"+h+"_2").removeClass("ui-state-active")),a("#"+g).data("disabled")===!0&&(a(".confirm","#"+j.themodal).hide(),a("#"+g).data("disabled",!1)),k&&k(a("#"+g)),a("#"+j.themodal).data("onClose",d.onClose),a.jgrid.viewModal("#"+j.themodal,{gbox:"#gbox_"+f,jqm:c.jqModal,jqM:!1,overlay:c.overlay,modal:c.modal}),x||a(".jqmOverlay").click(function(){if(!E())return!1;a.jgrid.hideModal("#"+j.themodal,{gb:"#gbox_"+f,jqm:c.jqModal,onClose:d.onClose});return!1}),l&&l(a("#"+g))}else{var I=isNaN(c.dataheight)?c.dataheight:c.dataheight+"px",J=a("<form name='FormPost' id='"+g+"' class='FormGrid' onSubmit='return false;' style='width:100%;overflow:auto;position:relative;height:"+I+";'></form>").data("disabled",!1),K=a("<table id='"+h+"' class='EditTable' cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>");m&&(q=m(a("#"+g)),typeof q=="undefined"&&(q=!0));if(q===!1)return;F(),a(e.p.colModel).each(function(a){var b=this.formoptions;r=Math.max(r,b?b.colpos||0:0),s=Math.max(s,b?b.rowpos||0:0)}),a(J).append(K);var L=a("<tr id='FormError' style='display:none'><td class='ui-state-error' colspan='"+r*2+"'></td></tr>");L[0].rp=0,a(K).append(L),L=a("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+r*2+"'>"+d.topinfo+"</td></tr>"),L[0].rp=0,a(K).append(L);var M=e.p.direction=="rtl"?!0:!1,N=M?"nData":"pData",O=M?"pData":"nData";z(b,e,K,r);var P="<a href='javascript:void(0)' id='"+N+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></a>",Q="<a href='javascript:void(0)' id='"+O+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></a>",R="<a href='javascript:void(0)' id='sData' class='fm-button ui-state-default ui-corner-all'>"+c.bSubmit+"</a>",S="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default ui-corner-all'>"+c.bCancel+"</a>",T="<table border='0' cellspacing='0' cellpadding='0' class='EditTable' id='"+h+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton'>"+(M?Q+P:P+Q)+"</td><td class='EditButton'>"+R+S+"</td></tr>";T+="<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+d.bottominfo+"</td></tr>",T+="</tbody></table>";if(s>0){var U=[];a.each(a(K)[0].rows,function(a,b){U[a]=b}),U.sort(function(a,b){if(a.rp>b.rp)return 1;if(a.rp<b.rp)return-1;return 0}),a.each(U,function(b,c){a("tbody",K).append(c)})}c.gbox="#gbox_"+f;var V=!1;c.closeOnEscape===!0&&(c.closeOnEscape=!1,V=!0);var W=a("<span></span>").append(J).append(T);a.jgrid.createModal(j,W,c,"#gview_"+e.p.id,a("#gbox_"+e.p.id)[0]),M&&(a("#pData, #nData","#"+h+"_2").css("float","right"),a(".EditButton","#"+h+"_2").css("text-align","left")),d.topinfo&&a(".tinfo","#"+h+"_2").show(),d.bottominfo&&a(".binfo","#"+h+"_2").show(),W=null,T=null,a("#"+j.themodal).keydown(function(b){var e=b.target;if(a("#"+g).data("disabled")===!0)return!1;if(d.savekey[0]===!0&&b.which==d.savekey[1]&&e.tagName!="TEXTAREA"){a("#sData","#"+h+"_2").trigger("click");return!1}if(b.which===27){if(!E())return!1;V&&a.jgrid.hideModal(this,{gb:c.gbox,jqm:c.jqModal,onClose:d.onClose});return!1}if(d.navkeys[0]===!0){if(a("#id_g","#"+h).val()=="_empty")return!0;if(b.which==d.navkeys[1]){a("#pData","#"+h+"_2").trigger("click");return!1}if(b.which==d.navkeys[2]){a("#nData","#"+h+"_2").trigger("click");return!1}}}),c.checkOnUpdate&&(a("a.ui-jqdialog-titlebar-close span","#"+j.themodal).removeClass("jqmClose"),a("a.ui-jqdialog-titlebar-close","#"+j.themodal).unbind("click").click(function(){if(!E())return!1;a.jgrid.hideModal("#"+j.themodal,{gb:"#gbox_"+f,jqm:c.jqModal,onClose:d.onClose});return!1})),c.saveicon=a.extend([!0,"left","ui-icon-disk"],c.saveicon),c.closeicon=a.extend([!0,"left","ui-icon-close"],c.closeicon),c.saveicon[0]===!0&&a("#sData","#"+h+"_2").addClass(c.saveicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+c.saveicon[2]+"'></span>"),c.closeicon[0]===!0&&a("#cData","#"+h+"_2").addClass(c.closeicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+c.closeicon[2]+"'></span>");if(d.checkOnSubmit||d.checkOnUpdate){R="<a href='javascript:void(0)' id='sNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+c.bYes+"</a>",Q="<a href='javascript:void(0)' id='nNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+c.bNo+"</a>",S="<a href='javascript:void(0)' id='cNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+c.bExit+"</a>";var X,Y=c.zIndex||999;Y++,a.browser.msie&&a.browser.version==6?X='<iframe style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');" src="javascript:false;"></iframe>':X="",a("<div class='ui-widget-overlay jqgrid-overlay confirm' style='z-index:"+Y+";display:none;'>&#160;"+X+"</div><div class='confirm ui-widget-content ui-jqconfirm' style='z-index:"+(Y+1)+"'>"+c.saveData+"<br/><br/>"+R+Q+S+"</div>").insertAfter("#"+g),a("#sNew","#"+j.themodal).click(function(){B(),a("#"+g).data("disabled",!1),a(".confirm","#"+j.themodal).hide();return!1}),a("#nNew","#"+j.themodal).click(function(){a(".confirm","#"+j.themodal).hide(),a("#"+g).data("disabled",!1),setTimeout(function(){a(":input","#"+g)[0].focus()},0);return!1}),a("#cNew","#"+j.themodal).click(function(){a(".confirm","#"+j.themodal).hide(),a("#"+g).data("disabled",!1),a.jgrid.hideModal("#"+j.themodal,{gb:"#gbox_"+f,jqm:c.jqModal,onClose:d.onClose});return!1})}n&&n(a("#"+g)),b=="_empty"||!d.viewPagerButtons?a("#pData,#nData","#"+h+"_2").hide():a("#pData,#nData","#"+h+"_2").show(),k&&k(a("#"+g)),a("#"+j.themodal).data("onClose",d.onClose),a.jgrid.viewModal("#"+j.themodal,{gbox:"#gbox_"+f,jqm:c.jqModal,overlay:c.overlay,modal:c.modal}),x||a(".jqmOverlay").click(function(){if(!E())return!1;a.jgrid.hideModal("#"+j.themodal,{gb:"#gbox_"+f,jqm:c.jqModal,onClose:d.onClose});return!1}),l&&l(a("#"+g)),a(".fm-button","#"+j.themodal).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}),a("#sData","#"+h+"_2").click(function(b){t={},u={},a("#FormError","#"+h).hide(),y(),t[e.p.id+"_id"]=="_empty"?B():c.checkOnSubmit===!0?(v=a.extend({},t,u),w=C(v,d._savedData),w?(a("#"+g).data("disabled",!0),a(".confirm","#"+j.themodal).show()):B()):B();return!1}),a("#cData","#"+h+"_2").click(function(b){if(!E())return!1;a.jgrid.hideModal("#"+j.themodal,{gb:"#gbox_"+f,jqm:c.jqModal,onClose:d.onClose});return!1}),a("#nData","#"+h+"_2").click(function(b){if(!E())return!1;a("#FormError","#"+h).hide();var d=H();d[0]=parseInt(d[0],10),d[0]!=-1&&d[1][d[0]+1]&&(a.isFunction(c.onclickPgButtons)&&c.onclickPgButtons("next",a("#"+g),d[1][d[0]]),A(d[1][d[0]+1],e,g),a(e).jqGrid("setSelection",d[1][d[0]+1]),a.isFunction(c.afterclickPgButtons)&&c.afterclickPgButtons("next",a("#"+g),d[1][d[0]+1]),G(d[0]+1,d[1].length-1));return!1}),a("#pData","#"+h+"_2").click(function(b){if(!E())return!1;a("#FormError","#"+h).hide();var d=H();d[0]!=-1&&d[1][d[0]-1]&&(a.isFunction(c.onclickPgButtons)&&c.onclickPgButtons("prev",a("#"+g),d[1][d[0]]),A(d[1][d[0]-1],e,g),a(e).jqGrid("setSelection",d[1][d[0]-1]),a.isFunction(c.afterclickPgButtons)&&c.afterclickPgButtons("prev",a("#"+g),d[1][d[0]-1]),G(d[0]-1,d[1].length-1));return!1})}var Z=H();G(Z[0],Z[1].length-1)}})},viewGridRow:function(b,c){c=a.extend({top:0,left:0,width:0,height:"auto",dataheight:"auto",modal:!1,overlay:10,drag:!0,resize:!0,jqModal:!0,closeOnEscape:!1,labelswidth:"30%",closeicon:[],navkeys:[!1,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:!0},a.jgrid.view,c||{});return this.each(function(){function r(){var b=a(d).jqGrid("getDataIDs"),c=a("#id_g","#"+g).val(),e=a.inArray(c,b);return[e,b]}function q(b,c){b===0?a("#pData","#"+g+"_2").addClass("ui-state-disabled"):a("#pData","#"+g+"_2").removeClass("ui-state-disabled"),b==c?a("#nData","#"+g+"_2").addClass("ui-state-disabled"):a("#nData","#"+g+"_2").removeClass("ui-state-disabled")}function o(b,c){var d,e,f=0,h,i,j;j=a(c).jqGrid("getInd",b,!0);!j||(a("td",j).each(function(b){d=c.p.colModel[b].name,c.p.colModel[b].editrules&&c.p.colModel[b].editrules.edithidden===!0?e=!1:e=c.p.colModel[b].hidden===!0?!0:!1,d!=="cb"&&d!=="subgrid"&&d!=="rn"&&(d==c.p.ExpandColumn&&c.p.treeGrid===!0?h=a(this).text():h=a(this).html(),i=a.extend({},c.p.colModel[b].editoptions||{}),d=a.jgrid.jqID("v_"+d),a("#"+d+" span","#"+g).html(h),e&&a("#"+d,"#"+g).parents("tr:first").hide(),f++)}),f>0&&a("#id_g","#"+g).val(b))}function n(b,d,e,f){var g,h,i,j=0,k,l,m=[],n=!1,o="<td class='CaptionTD form-view-label ui-widget-content' width='"+c.labelswidth+"'>&#160;</td><td class='DataTD form-view-data ui-helper-reset ui-widget-content'>&#160;</td>",q="",r="<td class='CaptionTD form-view-label ui-widget-content'>&#160;</td><td class='DataTD form-view-data ui-widget-content'>&#160;</td>",s=["integer","number","currency"],t=0,u=0,v,w,x;for(var y=1;y<=f;y++)q+=y==1?o:r;a(d.p.colModel).each(function(b){this.editrules&&this.editrules.edithidden===!0?h=!1:h=this.hidden===!0?!0:!1,!h&&this.align==="right"&&(this.formatter&&a.inArray(this.formatter,s)!==-1?t=Math.max(t,parseInt(this.width,10)):u=Math.max(u,parseInt(this.width,10)))}),v=t!==0?t:u!==0?u:0,n=a(d).jqGrid("getInd",b),a(d.p.colModel).each(function(b){g=this.name,w=!1,this.editrules&&this.editrules.edithidden===!0?h=!1:h=this.hidden===!0?!0:!1,l=h?"style='display:none'":"",x=typeof this.viewable!="boolean"?!0:this.viewable;if(g!=="cb"&&g!=="subgrid"&&g!=="rn"&&x){n===!1?k="":g==d.p.ExpandColumn&&d.p.treeGrid===!0?k=a("td:eq("+b+")",d.rows[n]).text():k=a("td:eq("+b+")",d.rows[n]).html(),w=this.align==="right"&&v!==0?!0:!1;var c=a.extend({},this.editoptions||{},{id:g,name:g}),o=a.extend({},{rowabove:!1,rowcontent:""},this.formoptions||{}),p=parseInt(o.rowpos,10)||j+1,r=parseInt((parseInt(o.colpos,10)||1)*2,10);if(o.rowabove){var s=a("<tr><td class='contentinfo' colspan='"+f*2+"'>"+o.rowcontent+"</td></tr>");a(e).append(s),s[0].rp=p}i=a(e).find("tr[rowpos="+p+"]"),i.length===0&&(i=a("<tr "+l+" rowpos='"+p+"'></tr>").addClass("FormData").attr("id","trv_"+g),a(i).append(q),a(e).append(i),i[0].rp=p),a("td:eq("+(r-2)+")",i[0]).html("<b>"+(typeof o.label=="undefined"?d.p.colNames[b]:o.label)+"</b>"),a("td:eq("+(r-1)+")",i[0]).append("<span>"+k+"</span>").attr("id","v_"+g),w&&a("td:eq("+(r-1)+") span",i[0]).css({"text-align":"right",width:v+"px"}),m[j]=b,j++}});if(j>0){var z=a("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(f*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+b+"'/></td></tr>");z[0].rp=j+99,a(e).append(z)}return m}function m(){(c.closeOnEscape===!0||c.navkeys[0]===!0)&&setTimeout(function(){a(".ui-jqdialog-titlebar-close","#"+h.modalhead).focus()},0)}var d=this;if(!!d.grid&&!!b){c.imgpath||(c.imgpath=d.p.imgpath);var e=d.p.id,f="ViewGrid_"+e,g="ViewTbl_"+e,h={themodal:"viewmod"+e,modalhead:"viewhd"+e,modalcontent:"viewcnt"+e,scrollelm:f},i=a.isFunction(c.beforeInitData)?c.beforeInitData:!1,j=!0,k=1,l=0;if(a("#"+h.themodal).html()!==null){i&&(j=i(a("#"+f)),typeof j=="undefined"&&(j=!0));if(j===!1)return;a(".ui-jqdialog-title","#"+h.modalhead).html(c.caption),a("#FormError","#"+g).hide(),o(b,d),a.isFunction(c.beforeShowForm)&&c.beforeShowForm(a("#"+f)),a.jgrid.viewModal("#"+h.themodal,{gbox:"#gbox_"+e,jqm:c.jqModal,jqM:!1,overlay:c.overlay,modal:c.modal}),m()}else{var s=isNaN(c.dataheight)?c.dataheight:c.dataheight+"px",t=a("<form name='FormPost' id='"+f+"' class='FormGrid' style='width:100%;overflow:auto;position:relative;height:"+s+";'></form>"),u=a("<table id='"+g+"' class='EditTable' cellspacing='1' cellpadding='2' border='0' style='table-layout:fixed'><tbody></tbody></table>");i&&(j=i(a("#"+f)),typeof j=="undefined"&&(j=!0));if(j===!1)return;a(d.p.colModel).each(function(a){var b=this.formoptions;k=Math.max(k,b?b.colpos||0:0),l=Math.max(l,b?b.rowpos||0:0)}),a(t).append(u),n(b,d,u,k);var v=d.p.direction=="rtl"?!0:!1,w=v?"nData":"pData",x=v?"pData":"nData",y="<a href='javascript:void(0)' id='"+w+"' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></a>",z="<a href='javascript:void(0)' id='"+x+"' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></a>",A="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default ui-corner-all'>"+c.bClose+"</a>";if(l>0){var B=[];a.each(a(u)[0].rows,function(a,b){B[a]=b}),B.sort(function(a,b){if(a.rp>b.rp)return 1;if(a.rp<b.rp)return-1;return 0}),a.each(B,function(b,c){a("tbody",u).append(c)})}c.gbox="#gbox_"+e;var C=!1;c.closeOnEscape===!0&&(c.closeOnEscape=!1,C=!0);var D=a("<span></span>").append(t).append("<table border='0' class='EditTable' id='"+g+"_2'><tbody><tr id='Act_Buttons'><td class='navButton' width='"+c.labelswidth+"'>"+(v?z+y:y+z)+"</td><td class='EditButton'>"+A+"</td></tr></tbody></table>");a.jgrid.createModal(h,D,c,"#gview_"+d.p.id,a("#gview_"+d.p.id)[0]),v&&(a("#pData, #nData","#"+g+"_2").css("float","right"),a(".EditButton","#"+g+"_2").css("text-align","left")),c.viewPagerButtons||a("#pData, #nData","#"+g+"_2").hide(),D=null,a("#"+h.themodal).keydown(function(b){if(b.which===27){C&&a.jgrid.hideModal(this,{gb:c.gbox,jqm:c.jqModal,onClose:c.onClose});return!1}if(c.navkeys[0]===!0){if(b.which===c.navkeys[1]){a("#pData","#"+g+"_2").trigger("click");return!1}if(b.which===c.navkeys[2]){a("#nData","#"+g+"_2").trigger("click");return!1}}}),c.closeicon=a.extend([!0,"left","ui-icon-close"],c.closeicon),c.closeicon[0]===!0&&a("#cData","#"+g+"_2").addClass(c.closeicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+c.closeicon[2]+"'></span>"),a.isFunction(c.beforeShowForm)&&c.beforeShowForm(a("#"+f)),a.jgrid.viewModal("#"+h.themodal,{gbox:"#gbox_"+e,jqm:c.jqModal,modal:c.modal}),a(".fm-button:not(.ui-state-disabled)","#"+g+"_2").hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}),m(),a("#cData","#"+g+"_2").click(function(b){a.jgrid.hideModal("#"+h.themodal,{gb:"#gbox_"+e,jqm:c.jqModal,onClose:c.onClose});return!1}),a("#nData","#"+g+"_2").click(function(b){a("#FormError","#"+g).hide();var e=r();e[0]=parseInt(e[0],10),e[0]!=-1&&e[1][e[0]+1]&&(a.isFunction(c.onclickPgButtons)&&c.onclickPgButtons("next",a("#"+f),e[1][e[0]]),o(e[1][e[0]+1],d),a(d).jqGrid("setSelection",e[1][e[0]+1]),a.isFunction(c.afterclickPgButtons)&&c.afterclickPgButtons("next",a("#"+f),e[1][e[0]+1]),q(e[0]+1,e[1
].length-1)),m();return!1}),a("#pData","#"+g+"_2").click(function(b){a("#FormError","#"+g).hide();var e=r();e[0]!=-1&&e[1][e[0]-1]&&(a.isFunction(c.onclickPgButtons)&&c.onclickPgButtons("prev",a("#"+f),e[1][e[0]]),o(e[1][e[0]-1],d),a(d).jqGrid("setSelection",e[1][e[0]-1]),a.isFunction(c.afterclickPgButtons)&&c.afterclickPgButtons("prev",a("#"+f),e[1][e[0]-1]),q(e[0]-1,e[1].length-1)),m();return!1})}var E=r();q(E[0],E[1].length-1)}})},delGridRow:function(b,c){c=a.extend({top:0,left:0,width:240,height:"auto",dataheight:"auto",modal:!1,overlay:10,drag:!0,resize:!0,url:"",mtype:"POST",reloadAfterSubmit:!0,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,jqModal:!0,closeOnEscape:!1,delData:{},delicon:[],cancelicon:[],onClose:null,ajaxDelOptions:{},processing:!1,serializeDelData:null,useDataProxy:!1},a.jgrid.del,c||{});var d=c;return this.each(function(){var e=this;if(!!e.grid){if(!b)return;var f=a.isFunction(c.beforeShowForm),g=a.isFunction(c.afterShowForm),h=a.isFunction(c.beforeInitData)?c.beforeInitData:!1,i=e.p.id,j={},k=!0,l="DelTbl_"+i,m,n,o,q,r={themodal:"delmod"+i,modalhead:"delhd"+i,modalcontent:"delcnt"+i,scrollelm:l};jQuery.isArray(b)&&(b=b.join());if(a("#"+r.themodal).html()!==null){h&&(k=h(a("#"+l)),typeof k=="undefined"&&(k=!0));if(k===!1)return;a("#DelData>td","#"+l).text(b),a("#DelError","#"+l).hide(),d.processing===!0&&(d.processing=!1,a("#dData","#"+l).removeClass("ui-state-active")),f&&c.beforeShowForm(a("#"+l)),a.jgrid.viewModal("#"+r.themodal,{gbox:"#gbox_"+i,jqm:c.jqModal,jqM:!1,overlay:c.overlay,modal:c.modal}),g&&c.afterShowForm(a("#"+l))}else{var s=isNaN(c.dataheight)?c.dataheight:c.dataheight+"px",t="<div id='"+l+"' class='formdata' style='width:100%;overflow:auto;position:relative;height:"+s+";'>";t+="<table class='DelTable'><tbody>",t+="<tr id='DelError' style='display:none'><td class='ui-state-error'></td></tr>",t+="<tr id='DelData' style='display:none'><td >"+b+"</td></tr>",t+='<tr><td class="delmsg" style="white-space:pre;">'+c.msg+"</td></tr><tr><td >&#160;</td></tr>",t+="</tbody></table></div>";var u="<a href='javascript:void(0)' id='dData' class='fm-button ui-state-default ui-corner-all'>"+c.bSubmit+"</a>",v="<a href='javascript:void(0)' id='eData' class='fm-button ui-state-default ui-corner-all'>"+c.bCancel+"</a>";t+="<table cellspacing='0' cellpadding='0' border='0' class='EditTable' id='"+l+"_2'><tbody><tr><td><hr class='ui-widget-content' style='margin:1px'/></td></tr></tr><tr><td class='DelButton EditButton'>"+u+"&#160;"+v+"</td></tr></tbody></table>",c.gbox="#gbox_"+i,a.jgrid.createModal(r,t,c,"#gview_"+e.p.id,a("#gview_"+e.p.id)[0]),h&&(k=h(a("#"+l)),typeof k=="undefined"&&(k=!0));if(k===!1)return;a(".fm-button","#"+l+"_2").hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}),c.delicon=a.extend([!0,"left","ui-icon-scissors"],c.delicon),c.cancelicon=a.extend([!0,"left","ui-icon-cancel"],c.cancelicon),c.delicon[0]===!0&&a("#dData","#"+l+"_2").addClass(c.delicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+c.delicon[2]+"'></span>"),c.cancelicon[0]===!0&&a("#eData","#"+l+"_2").addClass(c.cancelicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+c.cancelicon[2]+"'></span>"),a("#dData","#"+l+"_2").click(function(b){var f=[!0,""];j={};var g=a("#DelData>td","#"+l).text();a.isFunction(c.onclickSubmit)&&(j=c.onclickSubmit(d,g)||{}),a.isFunction(c.beforeSubmit)&&(f=c.beforeSubmit(g));if(f[0]&&!d.processing){d.processing=!0,a(this).addClass("ui-state-active"),o=e.p.prmNames,m=a.extend({},d.delData,j),q=o.oper,m[q]=o.deloper,n=o.id,m[n]=g;var h=a.extend({url:d.url?d.url:a(e).jqGrid("getGridParam","editurl"),type:c.mtype,data:a.isFunction(c.serializeDelData)?c.serializeDelData(m):m,complete:function(b,h){h!="success"?(f[0]=!1,a.isFunction(d.errorTextFormat)?f[1]=d.errorTextFormat(b):f[1]=h+" Status: '"+b.statusText+"'. Error code: "+b.status):a.isFunction(d.afterSubmit)&&(f=d.afterSubmit(b,m));if(f[0]===!1)a("#DelError>td","#"+l).html(f[1]),a("#DelError","#"+l).show();else{if(d.reloadAfterSubmit&&e.p.datatype!="local")a(e).trigger("reloadGrid");else{var j=[];j=g.split(",");if(e.p.treeGrid===!0)try{a(e).jqGrid("delTreeNode",j[0])}catch(k){}else for(var n=0;n<j.length;n++)a(e).jqGrid("delRowData",j[n]);e.p.selrow=null,e.p.selarrrow=[]}a.isFunction(d.afterComplete)&&setTimeout(function(){d.afterComplete(b,g)},500)}d.processing=!1,a("#dData","#"+l+"_2").removeClass("ui-state-active"),f[0]&&a.jgrid.hideModal("#"+r.themodal,{gb:"#gbox_"+i,jqm:c.jqModal,onClose:d.onClose})}},a.jgrid.ajaxOptions,c.ajaxDelOptions);!h.url&&!d.useDataProxy&&(a.isFunction(e.p.dataProxy)?d.useDataProxy=!0:(f[0]=!1,f[1]+=" "+a.jgrid.errors.nourl)),f[0]&&(d.useDataProxy?e.p.dataProxy.call(e,h,"del_"+e.p.id):a.ajax(h))}f[0]===!1&&(a("#DelError>td","#"+l).html(f[1]),a("#DelError","#"+l).show());return!1}),a("#eData","#"+l+"_2").click(function(b){a.jgrid.hideModal("#"+r.themodal,{gb:"#gbox_"+i,jqm:c.jqModal,onClose:d.onClose});return!1}),f&&c.beforeShowForm(a("#"+l)),a.jgrid.viewModal("#"+r.themodal,{gbox:"#gbox_"+i,jqm:c.jqModal,overlay:c.overlay,modal:c.modal}),g&&c.afterShowForm(a("#"+l))}c.closeOnEscape===!0&&setTimeout(function(){a(".ui-jqdialog-titlebar-close","#"+r.modalhead).focus()},0)}})},navGrid:function(b,c,d,e,f,g,h){c=a.extend({edit:!0,editicon:"ui-icon-pencil",add:!0,addicon:"ui-icon-plus",del:!0,delicon:"ui-icon-trash",search:!0,searchicon:"ui-icon-search",refresh:!0,refreshicon:"ui-icon-refresh",refreshstate:"firstpage",view:!1,viewicon:"ui-icon-document",position:"left",closeOnEscape:!0,beforeRefresh:null,afterRefresh:null,cloneToTop:!1},a.jgrid.nav,c||{});return this.each(function(){if(!this.nav){var i={themodal:"alertmod",modalhead:"alerthd",modalcontent:"alertcnt"},j=this,k,l,m,n;if(!j.grid||typeof b!="string")return;a("#"+i.themodal).html()===null&&(typeof window.innerWidth!="undefined"?(k=window.innerWidth,l=window.innerHeight):typeof document.documentElement!="undefined"&&typeof document.documentElement.clientWidth!="undefined"&&document.documentElement.clientWidth!==0?(k=document.documentElement.clientWidth,l=document.documentElement.clientHeight):(k=1024,l=768),a.jgrid.createModal(i,"<div>"+c.alerttext+"</div><span tabindex='0'><span tabindex='-1' id='jqg_alrt'></span></span>",{gbox:"#gbox_"+j.p.id,jqModal:!0,drag:!0,resize:!0,caption:c.alertcap,top:l/2-25,left:k/2-100,width:200,height:"auto",closeOnEscape:c.closeOnEscape},"","",!0));var p=1;c.cloneToTop&&j.p.toppager&&(p=2);for(var q=0;q<p;q++){var r,s=a("<table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table navtable' style='float:left;table-layout:auto;'><tbody><tr></tr></tbody></table>"),t="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>",u,v;q===0?(u=b,v=j.p.id,u==j.p.toppager&&(v+="_top",p=1)):(u=j.p.toppager,v=j.p.id+"_top"),j.p.direction=="rtl"&&a(s).attr("dir","rtl").css("float","right"),c.add&&(e=e||{},r=a("<td class='ui-pg-button ui-corner-all'></td>"),a(r).append("<div class='ui-pg-div'><span class='ui-icon "+c.addicon+"'></span>"+c.addtext+"</div>"),a("tr",s).append(r),a(r,s).attr({title:c.addtitle||"",id:e.id||"add_"+v}).click(function(){a(this).hasClass("ui-state-disabled")||(a.isFunction(c.addfunc)?c.addfunc():a(j).jqGrid("editGridRow","new",e));return!1}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}),r=null),c.edit&&(r=a("<td class='ui-pg-button ui-corner-all'></td>"),d=d||{},a(r).append("<div class='ui-pg-div'><span class='ui-icon "+c.editicon+"'></span>"+c.edittext+"</div>"),a("tr",s).append(r),a(r,s).attr({title:c.edittitle||"",id:d.id||"edit_"+v}).click(function(){if(!a(this).hasClass("ui-state-disabled")){var b=j.p.selrow;b?a.isFunction(c.editfunc)?c.editfunc(b):a(j).jqGrid("editGridRow",b,d):(a.jgrid.viewModal("#"+i.themodal,{gbox:"#gbox_"+j.p.id,jqm:!0}),a("#jqg_alrt").focus())}return!1}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}),r=null),c.view&&(r=a("<td class='ui-pg-button ui-corner-all'></td>"),h=h||{},a(r).append("<div class='ui-pg-div'><span class='ui-icon "+c.viewicon+"'></span>"+c.viewtext+"</div>"),a("tr",s).append(r),a(r,s).attr({title:c.viewtitle||"",id:h.id||"view_"+v}).click(function(){if(!a(this).hasClass("ui-state-disabled")){var b=j.p.selrow;b?a.isFunction(c.viewfunc)?c.viewfunc(b):a(j).jqGrid("viewGridRow",b,h):(a.jgrid.viewModal("#"+i.themodal,{gbox:"#gbox_"+j.p.id,jqm:!0}),a("#jqg_alrt").focus())}return!1}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}),r=null),c.del&&(r=a("<td class='ui-pg-button ui-corner-all'></td>"),f=f||{},a(r).append("<div class='ui-pg-div'><span class='ui-icon "+c.delicon+"'></span>"+c.deltext+"</div>"),a("tr",s).append(r),a(r,s).attr({title:c.deltitle||"",id:f.id||"del_"+v}).click(function(){if(!a(this).hasClass("ui-state-disabled")){var b;j.p.multiselect?(b=j.p.selarrrow,b.length===0&&(b=null)):b=j.p.selrow,b?"function"==typeof c.delfunc?c.delfunc(b):a(j).jqGrid("delGridRow",b,f):(a.jgrid.viewModal("#"+i.themodal,{gbox:"#gbox_"+j.p.id,jqm:!0}),a("#jqg_alrt").focus())}return!1}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}),r=null),(c.add||c.edit||c.del||c.view)&&a("tr",s).append(t),c.search&&(r=a("<td class='ui-pg-button ui-corner-all'></td>"),g=g||{},a(r).append("<div class='ui-pg-div'><span class='ui-icon "+c.searchicon+"'></span>"+c.searchtext+"</div>"),a("tr",s).append(r),a(r,s).attr({title:c.searchtitle||"",id:g.id||"search_"+v}).click(function(){a(this).hasClass("ui-state-disabled")||a(j).jqGrid("searchGrid",g);return!1}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}),g.showOnLoad&&g.showOnLoad===!0&&a(r,s).click(),r=null),c.refresh&&(r=a("<td class='ui-pg-button ui-corner-all'></td>"),a(r).append("<div class='ui-pg-div'><span class='ui-icon "+c.refreshicon+"'></span>"+c.refreshtext+"</div>"),a("tr",s).append(r),a(r,s).attr({title:c.refreshtitle||"",id:"refresh_"+v}).click(function(){if(!a(this).hasClass("ui-state-disabled")){a.isFunction(c.beforeRefresh)&&c.beforeRefresh(),j.p.search=!1;try{var b=j.p.id;j.p.postData.filters="",a("#fbox_"+b).jqFilter("resetFilter"),a.isFunction(j.clearToolbar)&&j.clearToolbar(!1)}catch(d){}switch(c.refreshstate){case"firstpage":a(j).trigger("reloadGrid",[{page:1}]);break;case"current":a(j).trigger("reloadGrid",[{current:!0}])}a.isFunction(c.afterRefresh)&&c.afterRefresh()}return!1}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}),r=null),n=a(".ui-jqgrid").css("font-size")||"11px",a("body").append("<div id='testpg2' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+n+";visibility:hidden;' ></div>"),m=a(s).clone().appendTo("#testpg2").width(),a("#testpg2").remove(),a(u+"_"+c.position,u).append(s),j.p._nvtd&&(m>j.p._nvtd[0]&&(a(u+"_"+c.position,u).width(m),j.p._nvtd[0]=m),j.p._nvtd[1]=m),n=null,m=null,s=null,this.nav=!0}}})},navButtonAdd:function(b,c){c=a.extend({caption:"newButton",title:"",buttonicon:"ui-icon-newwin",onClickButton:null,position:"last",cursor:"pointer"},c||{});return this.each(function(){if(!!this.grid){b.indexOf("#")!==0&&(b="#"+b);var d=a(".navtable",b)[0],e=this;if(d){if(c.id&&a("#"+c.id,d).html()!==null)return;var f=a("<td></td>");c.buttonicon.toString().toUpperCase()=="NONE"?a(f).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'>"+c.caption+"</div>"):a(f).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'><span class='ui-icon "+c.buttonicon+"'></span>"+c.caption+"</div>"),c.id&&a(f).attr("id",c.id),c.position=="first"?d.rows[0].cells.length===0?a("tr",d).append(f):a("tr td:eq(0)",d).before(f):a("tr",d).append(f),a(f,d).attr("title",c.title||"").click(function(b){a(this).hasClass("ui-state-disabled")||a.isFunction(c.onClickButton)&&c.onClickButton.call(e,b);return!1}).hover(function(){a(this).hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")})}}})},navSeparatorAdd:function(b,c){c=a.extend({sepclass:"ui-separator",sepcontent:""},c||{});return this.each(function(){if(!!this.grid){b.indexOf("#")!==0&&(b="#"+b);var d=a(".navtable",b)[0];if(d){var e="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='"+c.sepclass+"'></span>"+c.sepcontent+"</td>";a("tr",d).append(e)}}})},GridToForm:function(b,c){return this.each(function(){var d=this;if(!!d.grid){var e=a(d).jqGrid("getRowData",b);if(e)for(var f in e)a("[name="+a.jgrid.jqID(f)+"]",c).is("input:radio")||a("[name="+a.jgrid.jqID(f)+"]",c).is("input:checkbox")?a("[name="+a.jgrid.jqID(f)+"]",c).each(function(){a(this).val()==e[f]?a(this).attr("checked","checked"):a(this).attr("checked","")}):a("[name="+a.jgrid.jqID(f)+"]",c).val(e[f])}})},FormToGrid:function(b,c,d,e){return this.each(function(){var f=this;if(!!f.grid){d||(d="set"),e||(e="first");var g=a(c).serializeArray(),h={};a.each(g,function(a,b){h[b.name]=b.value}),d=="add"?a(f).jqGrid("addRowData",b,h,e):d=="set"&&a(f).jqGrid("setRowData",b,h)}})}})})(jQuery)